# EC2 Monitoring Log Rotation Configuration
# Rotates logs every 6 hours and keeps logs for 2 days
# Place this file in /etc/logrotate.d/ or run manually

/home/scadreau/surgicase/tests/ec2_monitoring*.log {
    # Rotate every 6 hours (4 times per day)
    size 1M
    rotate 8
    maxage 2
    
    # Compression and naming
    compress
    delaycompress
    dateext
    dateformat -%Y%m%d_%H%M%S
    
    # File handling
    missingok
    notifempty
    create 644 scadreau scadreau
    
    # Post-rotation actions
    postrotate
        # Signal any processes that might have the log file open
        /bin/kill -HUP `cat /var/run/rsyslogd.pid 2> /dev/null` 2> /dev/null || true
    endscript
    
    # Copy and truncate to avoid issues with processes holding file handles
    copytruncate
}
